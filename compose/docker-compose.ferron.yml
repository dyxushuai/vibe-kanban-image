services:
  vibe-kanban:
    image: ${VIBE_KANBAN_IMAGE}:${VIBE_KANBAN_TAG}
    container_name: vibe-kanban
    environment:
      HOST: 0.0.0.0
      PORT: 8080
    expose:
      - "8080"
    volumes:
      - ./data:/data
      - ${PROJECTS_DIR:-~/code}:/repos:rw
    restart: unless-stopped

  ferron:
    image: ferronserver/ferron:2
    container_name: vibe-kanban-ferron
    depends_on:
      - vibe-kanban
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./ferron/ferron.kdl:/etc/ferron.kdl:ro
      # Persistent automatic TLS (ACME) cache
      - ferron-acme:/var/lib/ferron-acme
      # Optional: manual TLS cert/key mount (see compose/ferron/ferron.kdl)
      # - ./ferron/tls:/etc/ferron/tls:ro
    restart: unless-stopped

volumes:
  ferron-acme:
